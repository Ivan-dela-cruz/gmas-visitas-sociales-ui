import{r as y,q,R as r,t as D,P as p,w as G,y as W,j as e,M as _,A as b,G as m,S as k,aS as L,b1 as B,I as M,B as U,k as J,Z as K,$ as h,aG as x,o as w,a0 as j,F as T}from"./index-CMlrmw9_.js";import{e as Q}from"./users-DNhK1xWS.js";import{F as X,c as Y,a as A}from"./formik.esm-CzWDJxwT.js";import{I as F}from"./InputLabel-BcyW2Dv4.js";import{E as I}from"./Eye-dLYNrfR4.js";import{E as P}from"./EyeSlash-BB-MsSTp.js";import{F as S}from"./FormHelperText-CoFCbm6G.js";var ee=["variant","color","size"],re=function(a){var s=a.color;return r.createElement(r.Fragment,null,r.createElement("path",{d:"M16.19 2H7.81C4.17 2 2 4.17 2 7.81v8.37C2 19.83 4.17 22 7.81 22h8.37c3.64 0 5.81-2.17 5.81-5.81V7.81C22 4.17 19.83 2 16.19 2ZM18 12.75H6c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h12c.41 0 .75.34.75.75s-.34.75-.75.75Z",fill:s}))},se=function(a){var s=a.color;return r.createElement(r.Fragment,null,r.createElement("path",{d:"M16 12h2M6 12h5.66",stroke:s,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},ae=function(a){var s=a.color;return r.createElement(r.Fragment,null,r.createElement("path",{opacity:".4",d:"M16.19 2H7.81C4.17 2 2 4.17 2 7.81v8.37C2 19.83 4.17 22 7.81 22h8.37c3.64 0 5.81-2.17 5.81-5.81V7.81C22 4.17 19.83 2 16.19 2Z",fill:s}),r.createElement("path",{d:"M18 12.75H6c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h12c.41 0 .75.34.75.75s-.34.75-.75.75Z",fill:s}))},z=function(a){var s=a.color;return r.createElement(r.Fragment,null,r.createElement("path",{d:"M6 12h12",stroke:s,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},ne=function(a){var s=a.color;return r.createElement(r.Fragment,null,r.createElement("path",{d:"M18 12.75H6c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h12c.41 0 .75.34.75.75s-.34.75-.75.75Z",fill:s}))},oe=function(a){var s=a.color;return r.createElement(r.Fragment,null,r.createElement("path",{d:"M6 12h12",stroke:s,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},te=function(a,s){switch(a){case"Bold":return r.createElement(re,{color:s});case"Broken":return r.createElement(se,{color:s});case"Bulk":return r.createElement(ae,{color:s});case"Linear":return r.createElement(z,{color:s});case"Outline":return r.createElement(ne,{color:s});case"TwoTone":return r.createElement(oe,{color:s});default:return r.createElement(z,{color:s})}},i=y.forwardRef(function(n,a){var s=n.variant,v=n.color,l=n.size,C=q(n,ee);return r.createElement("svg",D({},C,{xmlns:"http://www.w3.org/2000/svg",ref:a,width:l,height:l,viewBox:"0 0 24 24",fill:"none"}),te(s,v))});i.propTypes={variant:p.oneOf(["Linear","Bold","Broken","Bulk","Outline","TwoTone"]),color:p.string,size:p.oneOfType([p.string,p.number])};i.defaultProps={variant:"Linear",color:"currentColor",size:"24"};i.displayName="Minus";function N(n){return new RegExp("^(?=.*[0-9]).+$").test(n)}function $(n){return new RegExp("^(?=.*[a-z]).+$").test(n)}function Z(n){return new RegExp("^(?=.*[A-Z]).+$").test(n)}function O(n){return new RegExp("^(?=.*[-+_!@#$%^&*.,?]).+$").test(n)}function R(n){return n.length>7}function he(){const n=G(),{user:a}=W(),[s,v]=y.useState(!1),[l,C]=y.useState(!1),H=()=>{v(!s)},V=()=>{C(!l)},E=t=>{t.preventDefault()};return e.jsx(_,{title:"Cambiar Contraseña",children:e.jsx(X,{initialValues:{password:"",confirm:"",submit:null},validationSchema:Y().shape({password:A().required("Nueva contraseña es requerido").matches(/^.*(?=.{8,})((?=.*[!@#$%^&*()\-_=+{};:,<.>]){1})(?=.*\d)((?=.*[a-z]){1})((?=.*[A-Z]){1}).*$/,"La contraseña debe contener al menos 8 caracteres, una mayúscula, un numero y un carácter especial"),confirm:A().required("Confirmar contraseña es requerido").test("confirm","Las contraseñas no coinciden.",(t,d)=>d.parent.password===t)}),onSubmit:async(t,{resetForm:d,setErrors:f,setStatus:g,setSubmitting:u})=>{try{const c=(a==null?void 0:a.userName)||(a==null?void 0:a.username)||(a==null?void 0:a.email);if(!c){b({open:!0,message:"No se encontro el usuario para actualizar la contrasena",variant:"alert",alert:{color:"warning"}}),u(!1);return}await Q(c,t.password),b({open:!0,message:"Contraseña cambiada correctamente.",variant:"alert",alert:{color:"success"}}),d(),g({success:!1}),u(!1),n("/apps/profiles/user/personal")}catch(c){g({success:!1}),f({submit:c.message}),u(!1)}},children:({errors:t,handleBlur:d,handleChange:f,handleSubmit:g,isSubmitting:u,touched:c,values:o})=>e.jsx("form",{noValidate:!0,onSubmit:g,children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsxs(m,{item:!0,container:!0,spacing:3,xs:12,sm:6,children:[e.jsxs(m,{item:!0,xs:12,children:[e.jsxs(k,{spacing:1,children:[e.jsx(F,{htmlFor:"password-password",children:"Nueva Contraseña"}),e.jsx(L,{placeholder:"Ingresa Nueva Contraseña",id:"password-password",type:s?"text":"password",value:o.password,name:"password",onBlur:d,onChange:f,endAdornment:e.jsx(B,{position:"end",children:e.jsx(M,{"aria-label":"toggle password visibility",onClick:H,onMouseDown:E,edge:"end",size:"large",color:"secondary",children:s?e.jsx(I,{}):e.jsx(P,{})})}),autoComplete:"new-password"})]}),c.password&&t.password&&e.jsx(S,{error:!0,id:"password-password-helper",children:t.password})]}),e.jsxs(m,{item:!0,xs:12,children:[e.jsxs(k,{spacing:1,children:[e.jsx(F,{htmlFor:"password-confirm",children:"Confirmar Contraseña"}),e.jsx(L,{placeholder:"Ingrese Confirmar Contraseña",id:"password-confirm",type:l?"text":"password",value:o.confirm,name:"confirm",onBlur:d,onChange:f,endAdornment:e.jsx(B,{position:"end",children:e.jsx(M,{"aria-label":"toggle password visibility",onClick:V,onMouseDown:E,edge:"end",size:"large",color:"secondary",children:l?e.jsx(I,{}):e.jsx(P,{})})}),autoComplete:"new-password"})]}),c.confirm&&t.confirm&&e.jsx(S,{error:!0,id:"password-confirm-helper",children:t.confirm})]})]}),e.jsx(m,{item:!0,xs:12,sm:6,children:e.jsxs(U,{sx:{p:{xs:0,sm:2,md:4,lg:5}},children:[e.jsx(J,{variant:"h5",children:"La nueva contraseña debe contener:"}),e.jsxs(K,{sx:{p:0,mt:1},children:[e.jsxs(h,{divider:!0,children:[e.jsx(x,{sx:{color:R(o.password)?"success.main":"inherit"},children:R(o.password)?e.jsx(w,{}):e.jsx(i,{})}),e.jsx(j,{primary:"Al menos 8 caracteres"})]}),e.jsxs(h,{divider:!0,children:[e.jsx(x,{sx:{color:$(o.password)?"success.main":"inherit"},children:$(o.password)?e.jsx(w,{}):e.jsx(i,{})}),e.jsx(j,{primary:"Al menos 1 letra minúscula (a-z)"})]}),e.jsxs(h,{divider:!0,children:[e.jsx(x,{sx:{color:Z(o.password)?"success.main":"inherit"},children:Z(o.password)?e.jsx(w,{}):e.jsx(i,{})}),e.jsx(j,{primary:"Al menos 1 letra mayúscula (A-Z)"})]}),e.jsxs(h,{divider:!0,children:[e.jsx(x,{sx:{color:N(o.password)?"success.main":"inherit"},children:N(o.password)?e.jsx(w,{}):e.jsx(i,{})}),e.jsx(j,{primary:"Al menos 1 número (0-9)"})]}),e.jsxs(h,{children:[e.jsx(x,{sx:{color:O(o.password)?"success.main":"inherit"},children:O(o.password)?e.jsx(w,{}):e.jsx(i,{})}),e.jsx(j,{primary:"Al menos 1 carácter especial"})]})]})]})}),e.jsx(m,{item:!0,xs:12,children:e.jsxs(k,{direction:"row",justifyContent:"flex-end",alignItems:"center",spacing:2,children:[e.jsx(T,{type:"button",variant:"outlined",color:"secondary",onClick:()=>n(-2),children:"Cancelar"}),e.jsx(T,{disabled:u||Object.keys(t).length!==0,type:"submit",variant:"contained",children:"Guardar"})]})})]})})})})}export{he as default};
