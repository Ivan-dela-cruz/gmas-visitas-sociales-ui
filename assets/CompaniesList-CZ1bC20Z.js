import{j as t,k as f,S as h,aA as E,C as F,v as x,Q as v,w as T,r as n,A as m,O as N,M as w}from"./index-3l9d1KGW.js";import{B as z}from"./index-CX0mAAqE.js";import{T as D,u as R,C as H}from"./useConfirmDialog-Cj1zXZm7.js";import{C as b}from"./Checkbox-Bj6tLyqd.js";import{E as M}from"./Edit-A4rURnLa.js";import"./CompanyForm-BfbZ8N63.js";import{u as B,d as L}from"./companies--kIqmThg.js";import"./ArrowLeft-D_8-p770.js";import"./TextField-ipHljcwd.js";import"./InputLabel-CWODz4nt.js";import"./FormHelperText-BXYwuqgf.js";import"./index.esm-C1Hzu-K8.js";import"./useFormErrorRecovery-nUWcN-GT.js";import"./CircularProgress-J6yogQxx.js";const P=a=>a.code||a.companyCode||"N/A",j=a=>a.name||a.companyName||"N/A",S=a=>a.image||a.imageUrl||a.logo||a.logoUrl||"",A=a=>(a.isActive??a.active??!0)===!0;function y({onEdit:a,onDelete:c}){return[{id:"select",header:({table:e})=>t.jsx(b,{checked:e.getIsAllPageRowsSelected(),indeterminate:e.getIsSomePageRowsSelected(),onChange:i=>{e.getToggleAllPageRowsSelectedHandler()(i)},sx:{padding:0}}),cell:({row:e})=>t.jsx(b,{checked:e.getIsSelected(),disabled:!e.getCanSelect(),onChange:i=>{e.getToggleSelectedHandler()(i)},sx:{padding:0}}),enableColumnFilter:!1,enableSorting:!1,enableHiding:!1,size:50,meta:{skipFilter:!0}},{header:"Codigo",accessorKey:"code",cell:({row:e})=>t.jsx(f,{variant:"subtitle2",fontWeight:600,children:P(e.original)}),enableColumnFilter:!0,filterFn:"includesString"},{header:"Nombre",accessorKey:"name",cell:({row:e})=>j(e.original),enableColumnFilter:!0,filterFn:"includesString"},{header:"Imagen",id:"image",accessorFn:e=>S(e),cell:({row:e})=>{const i=e.original,s=S(i),l=j(i);return t.jsxs(h,{direction:"row",alignItems:"center",spacing:1,children:[t.jsx(E,{src:s||void 0,alt:l,sx:{width:32,height:32},children:(l==null?void 0:l[0])||"C"}),t.jsx(f,{variant:"body2",color:"text.secondary",children:s?"Cargada":"Sin imagen"})]})},enableColumnFilter:!0,filterFn:"includesString"},{header:"Estado",id:"isActive",accessorFn:e=>A(e)?"Activa":"Inactiva",cell:({row:e})=>{const i=A(e.original);return t.jsx(F,{label:i?"Activa":"Inactiva",color:i?"success":"default",size:"small",variant:"light"})},enableColumnFilter:!0,filterFn:"includesString",meta:{filterComponent:"select",options:[{value:"",label:"Todos"},{value:"Activa",label:"Activa"},{value:"Inactiva",label:"Inactiva"}]}},{header:"Acciones",id:"actions",cell:({row:e})=>{const i=e.original;return t.jsxs(h,{direction:"row",spacing:.5,alignItems:"center",children:[a&&t.jsx(x,{title:"Editar",children:t.jsx(v,{size:"small",color:"primary",onClick:()=>a(i),children:t.jsx(M,{size:18})})}),c&&t.jsx(x,{title:"Eliminar",children:t.jsx(v,{size:"small",color:"error",onClick:()=>c(i),children:t.jsx(D,{size:18})})})]})},enableSorting:!1,enableColumnFilter:!1,size:160}]}function ae(){const a=T(),{companies:c,companiesLoading:e,refreshCompanies:i}=B(),{dialogState:s,openDialog:l,closeDialog:d}=R(),g=r=>(r==null?void 0:r.id)??(r==null?void 0:r.companyId)??null,u=n.useCallback(r=>{const o=g(r);o&&a(`/apps/companies/edit/${o}`)},[a]),C=n.useCallback(r=>{const o=g(r);if(!o){m({open:!0,message:"No se pudo identificar la compañia",variant:"alert",alert:{color:"error"}});return}l({title:"Eliminar Compañia",message:`¿Esta seguro de eliminar la compañia "${(r==null?void 0:r.name)||(r==null?void 0:r.companyName)||""}"?`,severity:"error",confirmText:"Eliminar",onConfirm:async()=>{try{await L(o),i&&await i(),m({open:!0,message:"Compañia eliminada exitosamente",variant:"alert",alert:{color:"success"}}),d()}catch{m({open:!0,message:"Error al eliminar la compañia",variant:"alert",alert:{color:"error"}})}}})},[d,l,i]),p=n.useCallback(()=>{a("/apps/companies/create")},[a]),I=n.useMemo(()=>y({onEdit:u,onDelete:C}),[u,C]),k=n.useMemo(()=>[{label:"Nueva Compañia",icon:t.jsx(N,{}),onClick:p,color:"primary",variant:"contained"}],[p]);return n.useEffect(()=>{i&&i()},[i]),t.jsxs(w,{content:!1,children:[t.jsx(z,{tableId:"companies-table",title:"Lista de Compañias",columns:I,data:c||[],loading:e,enableRowSelection:!0,filterOnHeaderVisible:!0,tableNowrap:!0,actions:k}),t.jsx(H,{open:s.open,title:s.title,message:s.message,onConfirm:s.onConfirm,onCancel:d,confirmText:s.confirmText,cancelText:s.cancelText,severity:s.severity})]})}export{ae as default};
