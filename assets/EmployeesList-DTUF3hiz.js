import{r as i,q as D,R as t,t as V,P as u,j as n,k as M,C as v,S as P,v as y,I as k,w as H,x as R,y as A,z as K,A as f,M as O,B as $}from"./index-CMlrmw9_.js";import{B as W}from"./index-DhC-z79l.js";import{T as G,u as q,C as J}from"./useConfirmDialog-CW-ri43z.js";import{u as Q,e as F,s as U,d as X}from"./employees-DD63gYqJ.js";import{C as T}from"./Checkbox-ClaEhg--.js";import{E as Y}from"./Eye-dLYNrfR4.js";import{E as Z}from"./Edit-CaHYjH35.js";import{C as _}from"./CircularProgress-C4wVOatm.js";import"./ArrowLeft-A6bVVC6K.js";import"./TextField-B_-UPyso.js";import"./InputLabel-BcyW2Dv4.js";import"./FormHelperText-CoFCbm6G.js";var ee=["variant","color","size"],te=function(o){var e=o.color;return t.createElement(t.Fragment,null,t.createElement("path",{fill:e,d:"M14.55 22.42c-.33 0-.64-.22-.73-.56-.1-.4.13-.81.53-.92a9.256 9.256 0 006.89-8.95c0-5.1-4.15-9.25-9.25-9.25-4.33 0-7.17 2.53-8.5 4.06h2.94c.41 0 .75.34.75.75s-.32.76-.74.76H2.01c-.07 0-.14-.01-.21-.03a.899.899 0 01-.24-.12.659.659 0 01-.21-.23c-.05-.1-.09-.2-.1-.31V3c0-.41.34-.75.75-.75s.75.34.75.75v2.39C4.38 3.64 7.45 1.25 12 1.25c5.93 0 10.75 4.82 10.75 10.75 0 4.88-3.29 9.16-8.01 10.4-.06.01-.13.02-.19.02zM11.29 22.73c-.02 0-.05 0-.07-.01-1.07-.07-2.12-.31-3.12-.7a.751.751 0 01-.43-.97c.15-.38.59-.58.97-.43.86.34 1.77.54 2.69.61h.01c.4.02.7.36.7.76v.04a.76.76 0 01-.75.7zm-5.51-2.15c-.17 0-.33-.05-.47-.16-.84-.67-1.57-1.46-2.18-2.35a.73.73 0 01.19-1.04.76.76 0 011.04.19c.53.77 1.16 1.45 1.89 2.02.17.14.28.35.28.58 0 .17-.05.34-.16.48-.14.18-.36.28-.59.28zM2.44 15.7c-.33 0-.62-.21-.71-.52-.32-1.03-.48-2.1-.48-3.18 0-.41.34-.75.75-.75s.75.34.75.75c0 .93.14 1.85.41 2.73.02.07.03.15.03.23 0 .33-.21.61-.52.71-.08.02-.15.03-.23.03z"}),t.createElement("path",{fill:e,d:"M12 16a4 4 0 100-8 4 4 0 000 8z"}))},re=function(o){var e=o.color;return t.createElement(t.Fragment,null,t.createElement("path",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M14.55 21.67C18.84 20.54 22 16.64 22 12c0-5.52-4.44-10-10-10C5.33 2 2 7.56 2 7.56m0 0V3m0 4.56H6.44"}),t.createElement("path",{stroke:e,strokeDasharray:"3 3",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M2 12c0 5.52 4.48 10 10 10"}))},ae=function(o){var e=o.color;return t.createElement(t.Fragment,null,t.createElement("path",{fill:e,d:"M14.55 22.42c-.33 0-.64-.22-.73-.56-.1-.4.13-.81.53-.92a9.256 9.256 0 006.89-8.95c0-5.1-4.15-9.25-9.25-9.25-4.33 0-7.17 2.53-8.5 4.06h2.94c.41 0 .75.34.75.75s-.32.76-.74.76H2.01c-.07 0-.14-.01-.21-.03a.899.899 0 01-.24-.12.659.659 0 01-.21-.23c-.05-.1-.09-.2-.1-.31V3c0-.41.34-.75.75-.75s.75.34.75.75v2.39C4.38 3.64 7.45 1.25 12 1.25c5.93 0 10.75 4.82 10.75 10.75 0 4.88-3.29 9.16-8.01 10.4-.06.01-.13.02-.19.02z",opacity:".4"}),t.createElement("path",{fill:e,d:"M11.29 22.73c-.02 0-.05 0-.07-.01-1.07-.07-2.12-.31-3.12-.7a.751.751 0 01-.43-.97c.15-.38.59-.58.97-.43.86.34 1.77.54 2.69.61h.01c.4.02.7.36.7.76v.04a.76.76 0 01-.75.7zm-5.51-2.15c-.17 0-.33-.05-.47-.16-.84-.67-1.57-1.46-2.18-2.35a.73.73 0 01.19-1.04.76.76 0 011.04.19c.53.77 1.16 1.45 1.89 2.02.17.14.28.35.28.58 0 .17-.05.34-.16.48-.14.18-.36.28-.59.28zM2.44 15.7c-.33 0-.62-.21-.71-.52-.32-1.03-.48-2.1-.48-3.18 0-.41.34-.75.75-.75s.75.34.75.75c0 .93.14 1.85.41 2.73.02.07.03.15.03.23 0 .33-.21.61-.52.71-.08.02-.15.03-.23.03z"}),t.createElement("path",{fill:e,d:"M12 16a4 4 0 100-8 4 4 0 000 8z",opacity:".4"}))},L=function(o){var e=o.color;return t.createElement(t.Fragment,null,t.createElement("path",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M14.55 21.67C18.84 20.54 22 16.64 22 12c0-5.52-4.44-10-10-10C5.33 2 2 7.56 2 7.56m0 0V3m0 4.56H6.44"}),t.createElement("path",{stroke:e,strokeDasharray:"3 3",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M2 12c0 5.52 4.48 10 10 10"}))},ne=function(o){var e=o.color;return t.createElement(t.Fragment,null,t.createElement("path",{fill:e,d:"M14.55 22.42c-.33 0-.64-.22-.73-.56-.11-.4.13-.81.54-.92a9.256 9.256 0 006.89-8.95c0-5.1-4.15-9.25-9.25-9.25-4.33 0-7.17 2.53-8.5 4.06h2.94a.755.755 0 010 1.51H2.01c-.05 0-.14-.01-.21-.03a.899.899 0 01-.24-.12.659.659 0 01-.21-.23.808.808 0 01-.1-.31V3c0-.41.34-.75.75-.75s.75.34.75.75v2.39C4.38 3.64 7.45 1.25 12 1.25c5.93 0 10.75 4.82 10.75 10.75 0 4.88-3.29 9.16-8.01 10.4-.06.01-.13.02-.19.02zM11.29 22.73c-.02 0-.04-.01-.05-.01-1.08-.07-2.14-.31-3.14-.7a.747.747 0 01-.43-.97c.15-.38.6-.57.97-.43.87.34 1.78.54 2.7.61.39.02.7.36.7.76l-.01.04c-.02.39-.35.7-.74.7zm-5.51-2.15c-.17 0-.33-.06-.47-.16-.84-.68-1.58-1.47-2.18-2.35a.73.73 0 01.19-1.04.77.77 0 011.04.18v.01c.01.01.02.03.03.04a9.21 9.21 0 001.86 1.98c.17.14.28.35.28.58 0 .17-.05.34-.16.48-.15.18-.36.28-.59.28zM2.44 15.7c-.33 0-.62-.21-.71-.52-.32-1.03-.48-2.1-.48-3.18v-.01c.01-.41.34-.74.75-.74s.75.34.75.75c0 .94.14 1.86.41 2.73.02.08.03.15.03.23a.747.747 0 01-.75.74z"}))},oe=function(o){var e=o.color;return t.createElement(t.Fragment,null,t.createElement("path",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M14.55 21.67C18.84 20.54 22 16.64 22 12c0-5.52-4.44-10-10-10C5.33 2 2 7.56 2 7.56m0 0V3m0 4.56H6.44"}),t.createElement("path",{stroke:e,strokeDasharray:"3 3",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M2 12c0 5.52 4.48 10 10 10",opacity:".4"}))},le=function(o,e){switch(o){case"Bold":return t.createElement(te,{color:e});case"Broken":return t.createElement(re,{color:e});case"Bulk":return t.createElement(ae,{color:e});case"Linear":return t.createElement(L,{color:e});case"Outline":return t.createElement(ne,{color:e});case"TwoTone":return t.createElement(oe,{color:e});default:return t.createElement(L,{color:e})}},h=i.forwardRef(function(l,o){var e=l.variant,a=l.color,r=l.size,s=D(l,ee);return t.createElement("svg",V({},s,{xmlns:"http://www.w3.org/2000/svg",ref:o,width:r,height:r,viewBox:"0 0 24 24",fill:"none"}),le(e,a))});h.propTypes={variant:u.oneOf(["Linear","Bold","Broken","Bulk","Outline","TwoTone"]),color:u.string,size:u.oneOfType([u.string,u.number])};h.defaultProps={variant:"Linear",color:"currentColor",size:"24"};h.displayName="Refresh2";const se=({onEdit:l,onDelete:o,onView:e}={})=>[{id:"select",header:({table:a})=>n.jsx(T,{checked:a.getIsAllPageRowsSelected(),indeterminate:a.getIsSomePageRowsSelected(),onChange:r=>{a.getToggleAllPageRowsSelectedHandler()(r)},sx:{padding:0}}),cell:({row:a})=>n.jsx(T,{checked:a.getIsSelected(),disabled:!a.getCanSelect(),onChange:r=>{a.getToggleSelectedHandler()(r)},sx:{padding:0}}),enableColumnFilter:!1,enableSorting:!1,enableHiding:!1,size:50,meta:{skipFilter:!0}},{accessorKey:"id",header:"ID",cell:({getValue:a})=>{const r=a();return r?r.substring(0,8)+"...":"N/A"},enableColumnFilter:!0,size:100,filterFn:"includesString",defaultIsVisible:!1,toolTip:"ID del empleado"},{accessorKey:"identification",header:"Cédula",enableColumnFilter:!0,size:120,filterFn:"includesString"},{accessorKey:"firstName",header:"Nombre Completo",cell:({row:a})=>{const{firstName:r,middleName:s,lastName:m,secondLastName:p}=a.original,g=`${r||""} ${s||""} ${m||""} ${p||""}`.trim();return n.jsx(M,{variant:"subtitle1",children:g||"N/A"})},enableColumnFilter:!0,size:250,filterFn:"includesString"},{accessorKey:"dateBirth",header:"Fecha de Nacimiento",cell:({getValue:a})=>{const r=a();return r?new Date(r).toLocaleDateString("es-ES"):"N/A"},enableColumnFilter:!1,size:150},{accessorKey:"cellphoneNumber",header:"Celular",cell:({getValue:a})=>a()||"N/A",enableColumnFilter:!0,size:120,filterFn:"includesString"},{accessorKey:"degreeObtained",header:"Título Obtenido",enableColumnFilter:!0,size:150,filterFn:"includesString",defaultIsVisible:!1},{accessorKey:"emergencyContact",header:"Contacto de Emergencia",enableColumnFilter:!0,size:200,filterFn:"includesString",defaultIsVisible:!1},{accessorKey:"emergencyContactPhone",header:"Teléfono de Emergencia",enableColumnFilter:!0,size:150,filterFn:"includesString",defaultIsVisible:!1},{accessorKey:"status",header:"Estado",cell:a=>{const r=a.getValue();return r===!0||r==="active"||r===1?n.jsx(v,{color:"success",label:"Activo",size:"small",variant:"light"}):r===!1||r==="inactive"||r===0?n.jsx(v,{color:"error",label:"Inactivo",size:"small",variant:"light"}):n.jsx(v,{color:"info",label:"Desconocido",size:"small",variant:"light"})},enableColumnFilter:!1,size:100},{id:"actions",header:"Acciones",accessorKey:"actions",cell:({row:a})=>{const r=a.original;return n.jsxs(P,{direction:"row",alignItems:"center",justifyContent:"center",spacing:0,children:[e&&n.jsx(y,{title:"Ver",children:n.jsx(k,{color:"secondary",onClick:s=>{s.stopPropagation(),e(r)},children:n.jsx(Y,{})})}),l&&n.jsx(y,{title:"Editar",children:n.jsx(k,{color:"primary",onClick:s=>{s.stopPropagation(),l(r)},children:n.jsx(Z,{})})}),o&&n.jsx(y,{title:"Eliminar",children:n.jsx(k,{color:"error",onClick:s=>{s.stopPropagation(),o(r)},children:n.jsx(G,{})})})]})},enableColumnFilter:!1,enableSorting:!1,enableHiding:!1,size:120,meta:{skipFilter:!0}}];function ke(){var S;const l=H(),o=R(),{selectedCompany:e}=A(),a=!!((S=o.state)!=null&&S.refresh),{employeesLoading:r,employees:s}=Q(e==null?void 0:e.companyId,{revalidateOnMount:!a}),[m,p]=i.useState(!1),[g,x]=i.useState(!1),{dialogState:c,openDialog:C,closeDialog:E}=q();i.useEffect(()=>{a&&(e!=null&&e.companyId)&&(x(!0),K(F.key+F.list(e.companyId)).finally(()=>{x(!1)}),l(o.pathname,{replace:!0,state:{}})),window.scrollTo({top:0,left:0,behavior:"auto"})},[o.pathname,l,e,a]);const b=i.useCallback(d=>{l(`/apps/employees/edit/${d.id}`)},[l]),z=i.useCallback(async()=>{p(!0);try{await U(e==null?void 0:e.companyId),f({open:!0,message:"Empleados sincronizados exitosamente",variant:"alert",alert:{color:"success"}})}catch(d){f({open:!0,message:d.message||"Error al sincronizar empleados",variant:"alert",alert:{color:"error"}})}finally{p(!1)}},[e]),j=i.useCallback(async d=>{const I=`${d.firstName||""} ${d.lastName||""}`.trim();C({title:"Eliminar Empleado",message:`¿Está seguro de eliminar al empleado ${I}?`,severity:"error",confirmText:"Eliminar",onConfirm:async()=>{try{await X(d.id,e==null?void 0:e.companyId),f({open:!0,message:"Empleado eliminado exitosamente",variant:"alert",alert:{color:"success"}}),E()}catch(N){f({open:!0,message:N.message||"Error al eliminar el empleado",variant:"alert",alert:{color:"error"}})}}})},[E,C,e]),w=i.useMemo(()=>[{label:m?"Sincronizando...":"Sincronizar Empleados",icon:n.jsx(h,{}),onClick:z,color:"secondary",variant:"outlined",disabled:m}],[z,m]),B=i.useMemo(()=>se({onEdit:b,onDelete:j}),[b,j]);return r||g||m?n.jsx(O,{children:n.jsxs($,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"320px",children:[n.jsx(_,{}),n.jsx(M,{variant:"h6",align:"center",sx:{mt:2},children:"Cargando empleados..."})]})}):n.jsxs(n.Fragment,{children:[n.jsx(W,{tableId:"employees-general-table",title:"Lista de Empleados",columns:B,data:s,enableRowSelection:!0,filterOnHeaderVisible:!0,tableNowrap:!0,actions:w}),n.jsx(J,{open:c.open,title:c.title,message:c.message,onConfirm:c.onConfirm,onCancel:E,confirmText:c.confirmText,cancelText:c.cancelText,severity:c.severity})]})}export{ke as default};
