import{y as U,w as v,j as a,M as q,A as j,B as b,G as o,S as s,F as g,av as I}from"./index-C1pIq2vl.js";import{F as w,c as B,a as c}from"./formik.esm-BJieVtAb.js";import{c as S}from"./users-DtXYsbxr.js";import{I as d}from"./InputLabel-Bx_DgBK8.js";import{T as p}from"./TextField-BpgFI3H7.js";import{F as u}from"./FormHelperText-DKDoT4uR.js";function L(){return I()}function M(){const{user:e}=U(),h=v(),y=L(),x=(e==null?void 0:e.role)||(e==null?void 0:e.rol)||"User",C=x==="Admin"?"Admin":"Usuario",N=(e==null?void 0:e.email)||(e==null?void 0:e.email)||"User",A=(e==null?void 0:e.username)||(e==null?void 0:e.userName)||(e==null?void 0:e.email)||"User",F=(e==null?void 0:e.name)||(e==null?void 0:e.fullName)||"User";return a.jsx(q,{content:!1,title:"Información Personal ",sx:{"& .MuiInputLabel-root":{fontSize:"0.875rem"}},children:a.jsx(w,{initialValues:{firstname:A,lastname:F,email:N,rol:x,submit:null},validationSchema:B().shape({firstname:c().max(255).required("Nombre de Usuario es requerido."),lastname:c().max(255).required("Nombre Completo es requerido."),email:c().email("Correo invalido .").max(255).required("Correo es requerido."),rol:c().max(255).required("Rol es requerido.")}),onSubmit:async(r,{setErrors:n,setStatus:i,setSubmitting:m})=>{try{if(!(e!=null&&e.id))throw new Error("No se encontro el usuario.");const t=new Date().toISOString(),l={createdAt:(e==null?void 0:e.createdAt)||t,updatedAt:t,userCreatedBy:(e==null?void 0:e.userCreatedBy)||r.firstname,userUpdatedBy:r.firstname,id:e.id,userName:r.firstname,email:r.email,fullName:r.lastname,role:x,isActive:(e==null?void 0:e.isActive)??!0,lastLogin:(e==null?void 0:e.lastLogin)||t,companies:Array.isArray(e==null?void 0:e.companies)?e.companies:[]};await S(l),j({open:!0,message:"La información personal se actualizo correctamente.",variant:"alert",alert:{color:"success"}}),h("/dashboard/default"),i({success:!0}),m(!1)}catch(t){j({open:!0,message:t.message||"No se pudo actualizar la informacion personal.",variant:"alert",alert:{color:"error"}}),i({success:!1}),n({submit:t.message}),m(!1)}},children:({errors:r,handleBlur:n,handleChange:i,handleSubmit:m,isSubmitting:t,touched:l,values:f})=>a.jsxs("form",{noValidate:!0,onSubmit:m,children:[a.jsx(b,{sx:{p:2.5},children:a.jsxs(o,{container:!0,spacing:3,children:[a.jsxs(o,{item:!0,xs:12,sm:6,children:[a.jsxs(s,{spacing:1,children:[a.jsx(d,{htmlFor:"personal-first-name",children:"Nombre de Usuario"}),a.jsx(p,{fullWidth:!0,id:"personal-first-name",value:f.firstname,name:"firstname",onBlur:n,onChange:i,placeholder:"Nombre de Usuario",autoFocus:!0,inputRef:y,disabled:!0})]}),l.firstname&&r.firstname&&a.jsx(u,{error:!0,id:"personal-first-name-helper",children:r.firstname})]}),a.jsxs(o,{item:!0,xs:12,sm:6,children:[a.jsxs(s,{spacing:1,children:[a.jsx(d,{htmlFor:"personal-last-name",children:"Nombre Completo"}),a.jsx(p,{fullWidth:!0,id:"personal-last-name",value:f.lastname,name:"lastname",onBlur:n,onChange:i,placeholder:"Nombre Completo"})]}),l.lastname&&r.lastname&&a.jsx(u,{error:!0,id:"personal-last-name-helper",children:r.lastname})]}),a.jsxs(o,{item:!0,xs:12,sm:6,children:[a.jsxs(s,{spacing:1,children:[a.jsx(d,{htmlFor:"personal-email",children:"Correo"}),a.jsx(p,{type:"email",fullWidth:!0,value:f.email,name:"email",onBlur:n,onChange:i,id:"personal-email",placeholder:"Correo"})]}),l.email&&r.email&&a.jsx(u,{error:!0,id:"personal-email-helper",children:r.email})]}),a.jsxs(o,{item:!0,xs:12,sm:6,children:[a.jsxs(s,{spacing:1,children:[a.jsx(d,{htmlFor:"personal-email",children:"Rol"}),a.jsx(p,{type:"text",fullWidth:!0,value:C,name:"rol",onBlur:n,onChange:i,id:"personal-rol",placeholder:"Rol",disabled:!0})]}),l.rol&&r.rol&&a.jsx(u,{error:!0,id:"personal-rol-helper",children:r.rol})]})]})}),a.jsx(b,{sx:{p:2.5},children:a.jsxs(s,{direction:"row",justifyContent:"flex-end",alignItems:"center",spacing:2,sx:{mt:2.5},children:[a.jsx(g,{type:"button",variant:"outlined",color:"secondary",onClick:()=>h(-1),children:"Cancelar"}),a.jsx(g,{disabled:t||Object.keys(r).length!==0,type:"submit",variant:"contained",children:"Guardar"})]})})]})})})}export{M as default};
