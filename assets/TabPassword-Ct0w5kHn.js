import{av as g,r as C,w as b,j as e,M as P,F as l,G as a,E as v,k as y,S as L,A as c}from"./index-pwr-e4Ht.js";import{u as S,C as u}from"./index.esm-B6J6p8Kq.js";import{e as T}from"./users-DWxc2WmK.js";import{A as k}from"./ArrowLeft-D0sQWMEh.js";import{T as x}from"./TextField-ChEHFDDT.js";import{C as z}from"./CircularProgress-JbuhKxWk.js";import"./InputLabel-BRdiyk76.js";import"./FormHelperText-vhUhcK_2.js";function G(){const{user:t}=g(),[o,d]=C.useState(!1),i=b(),{control:m,handleSubmit:p,watch:f,reset:w,formState:{errors:n}}=S({defaultValues:{newPassword:"",confirmPassword:""}}),h=f("newPassword"),j=async r=>{if(r.newPassword!==r.confirmPassword){c({open:!0,message:"Las contraseñas no coinciden",variant:"alert",alert:{color:"warning"}});return}d(!0);try{await T(t.userName,r.newPassword),c({open:!0,message:"Contraseña actualizada exitosamente",variant:"alert",alert:{color:"success"}}),w(),i("/apps/users/list")}catch(s){c({open:!0,message:s.message||"Error al cambiar la contraseña",variant:"alert",alert:{color:"error"}})}finally{d(!1)}};return e.jsx(P,{content:!1,title:"Cambiar Contraseña",secondary:e.jsx(l,{variant:"outlined",size:"small",startIcon:e.jsx(k,{}),onClick:()=>i("/apps/users/list"),sx:{fontWeight:600},children:"Regresar"}),sx:{"& .MuiInputLabel-root":{fontSize:"0.875rem"}},children:e.jsx("form",{onSubmit:p(j),children:e.jsxs(a,{container:!0,spacing:3,sx:{p:3},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(v,{severity:"info",children:"La contraseña debe tener al menos 8 caracteres."})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(y,{variant:"h6",gutterBottom:!0,children:["Usuario: ",e.jsx("strong",{children:t==null?void 0:t.userName})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"newPassword",control:m,rules:{required:"La contraseña es requerida",minLength:{value:8,message:"La contraseña debe tener al menos 8 caracteres"}},render:({field:r})=>{var s;return e.jsx(x,{...r,fullWidth:!0,label:"Nueva Contraseña *",type:"password",error:!!n.newPassword,helperText:(s=n.newPassword)==null?void 0:s.message})}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"confirmPassword",control:m,rules:{required:"Confirme la contraseña",validate:r=>r===h||"Las contraseñas no coinciden"},render:({field:r})=>{var s;return e.jsx(x,{...r,fullWidth:!0,label:"Confirmar Contraseña *",type:"password",error:!!n.confirmPassword,helperText:(s=n.confirmPassword)==null?void 0:s.message})}})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(L,{direction:"row",justifyContent:"flex-end",spacing:2,children:[e.jsx(l,{variant:"outlined",color:"secondary",onClick:()=>i("/apps/users/list"),disabled:o,children:"Cancelar"}),e.jsx(l,{type:"submit",variant:"contained",disabled:o,children:o?e.jsx(z,{size:24}):"Cambiar Contraseña"})]})})]})})})}export{G as default};
