import{y as q,w as v,j as a,M as I,A as j,B as b,G as o,S as i,F as g,av as S}from"./index-BBOMs4x0.js";import{F as R,c as k,a as c}from"./formik.esm-ke6X3Wb-.js";import{c as A}from"./users-DLXa9_eD.js";import{I as d}from"./InputLabel-SSW_zhyd.js";import{T as u}from"./TextField-CXDNqN6f.js";import{F as p}from"./FormHelperText-BS5u7Ss6.js";function B(){return S()}function O(){const{user:e,updateProfile:N}=q(),f=v(),C=B(),h=(e==null?void 0:e.role)||(e==null?void 0:e.rol)||"User",y=h==="Admin"?"Admin":"Usuario",F=(e==null?void 0:e.email)||(e==null?void 0:e.email)||"User",U=(e==null?void 0:e.username)||(e==null?void 0:e.userName)||(e==null?void 0:e.email)||"User",w=(e==null?void 0:e.name)||(e==null?void 0:e.fullName)||"User";return a.jsx(I,{content:!1,title:"Información Personal ",sx:{"& .MuiInputLabel-root":{fontSize:"0.875rem"}},children:a.jsx(R,{initialValues:{firstname:U,lastname:w,email:F,rol:h,submit:null},validationSchema:k().shape({firstname:c().max(255).required("Nombre de Usuario es requerido."),lastname:c().max(255).required("Nombre Completo es requerido."),email:c().email("Correo invalido .").max(255).required("Correo es requerido."),rol:c().max(255).required("Rol es requerido.")}),onSubmit:async(r,{setErrors:n,setStatus:s,setSubmitting:m})=>{try{if(!(e!=null&&e.id))throw new Error("No se encontro el usuario.");const t=new Date().toISOString(),l={...e,userName:r.firstname,email:r.email,fullName:r.lastname,updatedAt:t,userUpdatedBy:r.firstname};delete l.password,await A(l),await N(),j({open:!0,message:"La información personal se actualizo correctamente.",variant:"alert",alert:{color:"success"}}),f("/dashboard/default"),s({success:!0}),m(!1)}catch(t){j({open:!0,message:t.message||"No se pudo actualizar la informacion personal.",variant:"alert",alert:{color:"error"}}),s({success:!1}),n({submit:t.message}),m(!1)}},children:({errors:r,handleBlur:n,handleChange:s,handleSubmit:m,isSubmitting:t,touched:l,values:x})=>a.jsxs("form",{noValidate:!0,onSubmit:m,children:[a.jsx(b,{sx:{p:2.5},children:a.jsxs(o,{container:!0,spacing:3,children:[a.jsxs(o,{item:!0,xs:12,sm:6,children:[a.jsxs(i,{spacing:1,children:[a.jsx(d,{htmlFor:"personal-first-name",children:"Nombre de Usuario"}),a.jsx(u,{fullWidth:!0,id:"personal-first-name",value:x.firstname,name:"firstname",onBlur:n,onChange:s,placeholder:"Nombre de Usuario",autoFocus:!0,inputRef:C,disabled:!0})]}),l.firstname&&r.firstname&&a.jsx(p,{error:!0,id:"personal-first-name-helper",children:r.firstname})]}),a.jsxs(o,{item:!0,xs:12,sm:6,children:[a.jsxs(i,{spacing:1,children:[a.jsx(d,{htmlFor:"personal-last-name",children:"Nombre Completo"}),a.jsx(u,{fullWidth:!0,id:"personal-last-name",value:x.lastname,name:"lastname",onBlur:n,onChange:s,placeholder:"Nombre Completo"})]}),l.lastname&&r.lastname&&a.jsx(p,{error:!0,id:"personal-last-name-helper",children:r.lastname})]}),a.jsxs(o,{item:!0,xs:12,sm:6,children:[a.jsxs(i,{spacing:1,children:[a.jsx(d,{htmlFor:"personal-email",children:"Correo"}),a.jsx(u,{type:"email",fullWidth:!0,value:x.email,name:"email",onBlur:n,onChange:s,id:"personal-email",placeholder:"Correo"})]}),l.email&&r.email&&a.jsx(p,{error:!0,id:"personal-email-helper",children:r.email})]}),a.jsxs(o,{item:!0,xs:12,sm:6,children:[a.jsxs(i,{spacing:1,children:[a.jsx(d,{htmlFor:"personal-email",children:"Rol"}),a.jsx(u,{type:"text",fullWidth:!0,value:y,name:"rol",onBlur:n,onChange:s,id:"personal-rol",placeholder:"Rol",disabled:!0})]}),l.rol&&r.rol&&a.jsx(p,{error:!0,id:"personal-rol-helper",children:r.rol})]})]})}),a.jsx(b,{sx:{p:2.5},children:a.jsxs(i,{direction:"row",justifyContent:"flex-end",alignItems:"center",spacing:2,sx:{mt:2.5},children:[a.jsx(g,{type:"button",variant:"outlined",color:"secondary",onClick:()=>f(-1),children:"Cancelar"}),a.jsx(g,{disabled:t||Object.keys(r).length!==0,type:"submit",variant:"contained",children:"Guardar"})]})})]})})})}export{O as default};
