import{w as C,x as E,r as y,j as e,Z as S,aF as g,aG as j,aH as A,a0 as f,n as L,P as T,i as w,M as D,G as n,S as a,aI as P,T as u,k as t,aJ as z,X as N,F as W,A as v}from"./index-C1pIq2vl.js";import{L as B}from"./Lock-DM2PcQHG.js";import{u as R,T as M,C as $}from"./useConfirmDialog-Brskm5sG.js";import{d as G}from"./users-DtXYsbxr.js";function b(s){let i=0;return s.includes("/password")?i=2:s.includes("/companies")?i=1:s.includes("/personal")&&(i=0),i}function I({userId:s}){const i=C(),{pathname:o}=E(),[r,l]=y.useState(b(o)),c=(d,x)=>{l(d),i(x)};return y.useEffect(()=>{l(b(o))},[o]),e.jsxs(S,{component:"nav",sx:{p:0,"& .MuiListItemIcon-root":{minWidth:32,color:"secondary.main"}},children:[e.jsxs(g,{selected:r===0,onClick:()=>c(0,`/apps/users/${s}/profile/personal`),children:[e.jsx(j,{children:e.jsx(A,{size:18})}),e.jsx(f,{primary:"Información Personal"})]}),e.jsxs(g,{selected:r===1,onClick:()=>c(1,`/apps/users/${s}/profile/companies`),children:[e.jsx(j,{children:e.jsx(L,{size:18})}),e.jsx(f,{primary:"Empresas Asignadas"})]}),e.jsxs(g,{selected:r===2,onClick:()=>c(2,`/apps/users/${s}/profile/password`),children:[e.jsx(j,{children:e.jsx(B,{size:18})}),e.jsx(f,{primary:"Cambiar Contraseña"})]})]})}I.propTypes={userId:T.string};function F({user:s}){const i=w(),o=C(),{dialogState:r,openDialog:l,closeDialog:c}=R(),d=async()=>{l({title:"Eliminar Usuario",message:`¿Está seguro de eliminar el usuario "${s==null?void 0:s.userName}"? Esta acción no se puede deshacer.`,severity:"error",confirmText:"Eliminar",onConfirm:async()=>{try{await G(s.id),v({open:!0,message:"Usuario eliminado exitosamente",variant:"alert",alert:{color:"success"}}),o("/apps/users/list")}catch{v({open:!0,message:"Error al eliminar el usuario",variant:"alert",alert:{color:"error"}})}}})},x=h=>h?h.split(" ").filter(Boolean).map(k=>k[0]).join("").toUpperCase().substring(0,2):"U",m=(s==null?void 0:s.fullName)||(s==null?void 0:s.userName)||"Usuario",p=(s==null?void 0:s.role)||"User",U=p==="Admin"?"Administrador":p==="User"?"Usuario":p;return e.jsxs(D,{children:[e.jsxs(n,{container:!0,spacing:3,children:[e.jsx(n,{item:!0,xs:12,children:e.jsxs(a,{spacing:1.5,alignItems:"center",children:[e.jsx(P,{alt:m,sx:{width:100,height:100,border:"1px dashed",fontSize:"2rem",bgcolor:i.palette.mode===u.DARK?"primary.dark":"primary.lighter",color:"primary.main"},children:x(m)}),e.jsxs(a,{spacing:.5,alignItems:"center",children:[e.jsx(t,{variant:"h6",sx:{fontWeight:600},children:m}),e.jsx(t,{variant:"body2",color:"secondary",children:U})]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(a,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",children:[e.jsx(z,{size:18,color:i.palette.text.secondary,variant:"Bulk"}),e.jsxs(a,{spacing:0,children:[e.jsx(t,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:"Registrado"}),e.jsx(t,{variant:"body2",sx:{fontWeight:500,textAlign:"center"},children:s!=null&&s.createdAt?new Date(s.createdAt).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"}):"N/A"})]})]})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(I,{userId:s==null?void 0:s.id})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(N,{sx:{my:1}})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(a,{spacing:1.5,children:[e.jsx(t,{variant:"h6",color:"error.main",sx:{fontWeight:600},children:"Zona de Peligro"}),e.jsxs(a,{spacing:2,sx:{p:2,borderRadius:1,border:"1px solid",borderColor:"error.light",bgcolor:i.palette.mode===u.DARK?"error.darker":"error.lighter"},children:[e.jsxs(a,{spacing:.5,children:[e.jsx(t,{variant:"subtitle1",sx:{fontWeight:600},children:"Eliminar este usuario"}),e.jsx(t,{variant:"body2",color:"text.secondary",children:"Una vez eliminado, no hay vuelta atrás."})]}),e.jsx(W,{variant:"contained",color:"error",startIcon:e.jsx(M,{}),onClick:d,sx:{width:"fit-content",fontWeight:600,boxShadow:"none","&:hover":{boxShadow:"none"}},children:"Eliminar"})]})]})})]}),e.jsx($,{open:r.open,title:r.title,message:r.message,onConfirm:r.onConfirm,onCancel:c,confirmText:r.confirmText,cancelText:r.cancelText,severity:r.severity})]})}F.propTypes={user:T.object};export{F as U};
