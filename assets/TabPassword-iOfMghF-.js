import{av as g,r as C,w as b,j as e,M as P,F as i,G as a,E as v,k as y,S as L,A as l}from"./index-C1pIq2vl.js";import{u as S,C as u}from"./index.esm-Gj4MCmXn.js";import{e as T}from"./users-DtXYsbxr.js";import{A as k}from"./ArrowLeft-REL-uIIU.js";import{T as x}from"./TextField-BpgFI3H7.js";import{C as z}from"./CircularProgress-DEhu9n-n.js";import"./InputLabel-Bx_DgBK8.js";import"./FormHelperText-DKDoT4uR.js";function G(){const{user:t}=g(),[o,c]=C.useState(!1),f=b(),{control:d,handleSubmit:w,watch:p,reset:m,formState:{errors:n}}=S({defaultValues:{newPassword:"",confirmPassword:""}}),h=p("newPassword"),j=async r=>{if(r.newPassword!==r.confirmPassword){l({open:!0,message:"Las contraseñas no coinciden",variant:"alert",alert:{color:"warning"}});return}c(!0);try{await T(t.userName,r.newPassword),l({open:!0,message:"Contraseña actualizada exitosamente",variant:"alert",alert:{color:"success"}}),m()}catch(s){l({open:!0,message:s.message||"Error al cambiar la contraseña",variant:"alert",alert:{color:"error"}})}finally{c(!1)}};return e.jsx(P,{content:!1,title:"Cambiar Contraseña",secondary:e.jsx(i,{variant:"outlined",size:"small",startIcon:e.jsx(k,{}),onClick:()=>f("/apps/users/list"),sx:{fontWeight:600},children:"Regresar"}),sx:{"& .MuiInputLabel-root":{fontSize:"0.875rem"}},children:e.jsx("form",{onSubmit:w(j),children:e.jsxs(a,{container:!0,spacing:3,sx:{p:3},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(v,{severity:"info",children:"La contraseña debe tener al menos 8 caracteres."})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(y,{variant:"h6",gutterBottom:!0,children:["Usuario: ",e.jsx("strong",{children:t==null?void 0:t.userName})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"newPassword",control:d,rules:{required:"La contraseña es requerida",minLength:{value:8,message:"La contraseña debe tener al menos 8 caracteres"}},render:({field:r})=>{var s;return e.jsx(x,{...r,fullWidth:!0,label:"Nueva Contraseña *",type:"password",error:!!n.newPassword,helperText:(s=n.newPassword)==null?void 0:s.message})}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"confirmPassword",control:d,rules:{required:"Confirme la contraseña",validate:r=>r===h||"Las contraseñas no coinciden"},render:({field:r})=>{var s;return e.jsx(x,{...r,fullWidth:!0,label:"Confirmar Contraseña *",type:"password",error:!!n.confirmPassword,helperText:(s=n.confirmPassword)==null?void 0:s.message})}})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(L,{direction:"row",justifyContent:"flex-end",spacing:2,children:[e.jsx(i,{variant:"outlined",color:"secondary",onClick:()=>m(),disabled:o,children:"Cancelar"}),e.jsx(i,{type:"submit",variant:"contained",disabled:o,children:o?e.jsx(z,{size:24}):"Cambiar Contraseña"})]})})]})})})}export{G as default};
