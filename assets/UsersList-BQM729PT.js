import{r as h,q as Z,R as e,t as B,P as m,s as U,j as a,k,C as H,S as y,v as g,Q as v,w as N,M as $,F as D,O as V,A as f}from"./index-8i2qIeC5.js";import{B as I}from"./index-iPnnsK5M.js";import{T as K,u as R,C as P}from"./useConfirmDialog-BqEGclvE.js";import{C as w}from"./Checkbox-CUgLVUIU.js";import{S as X}from"./Switch-Cz8dkWLM.js";import{E as G}from"./Edit-C1XPeCcf.js";import{C as q,A as Q}from"./UserProfileCard-BUbzhc5O.js";import"./UserProfileTabs-BByuK1JG.js";import{u as J,d as Y,a as _}from"./users-YDXVqnkj.js";import"./ArrowLeft-D7tqb4HZ.js";import"./TextField-hsc-s2X2.js";import"./InputLabel-BPE1mrZ-.js";import"./FormHelperText-DxDomcnh.js";import"./index.esm-2MvEHrLl.js";import"./usersCompanies-X1X4nRDr.js";import"./companies-DdaDw0QJ.js";import"./useFormErrorRecovery-Dual0gFu.js";import"./CircularProgress-Ba8lmjXM.js";import"./Lock-CAlv8PgO.js";var ee=["variant","color","size"],re=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M19.789 4.22c-2.96-2.95-7.76-2.95-10.7 0-2.07 2.05-2.69 5-1.89 7.6l-4.7 4.7c-.33.34-.56 1.01-.49 1.49l.3 2.18c.11.72.78 1.4 1.5 1.5l2.18.3c.48.07 1.15-.15 1.49-.5l.82-.82c.2-.19.2-.51 0-.71l-1.94-1.94a.754.754 0 0 1 0-1.06c.29-.29.77-.29 1.06 0l1.95 1.95c.19.19.51.19.7 0l2.12-2.11c2.59.81 5.54.18 7.6-1.87 2.95-2.95 2.95-7.76 0-10.71ZM14.499 12a2.5 2.5 0 0 1 0-5 2.5 2.5 0 0 1 0 5Z",fill:r}))},te=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M12.989 2.15c2.38-.46 4.95.23 6.8 2.07 2.95 2.95 2.95 7.76 0 10.7a7.575 7.575 0 0 1-7.6 1.87l-4.71 4.7c-.34.35-1.01.56-1.49.49l-2.18-.3c-.72-.1-1.39-.78-1.5-1.5l-.3-2.18c-.07-.48.16-1.15.49-1.49l1.12-1.12 3.57-3.57c-.8-2.6-.18-5.55 1.88-7.6M6.89 17.488l2.3 2.3",stroke:r,strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),e.createElement("path",{d:"M14.5 11a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z",stroke:r,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},ae=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{opacity:".4",d:"M19.789 4.22c-2.96-2.95-7.76-2.95-10.7 0-2.07 2.05-2.69 5-1.89 7.6l-4.7 4.7c-.33.34-.56 1.01-.49 1.49l.3 2.18c.11.72.78 1.4 1.5 1.5l2.18.3c.48.07 1.15-.15 1.49-.5l.82-.82c.2-.19.2-.51 0-.71l-1.94-1.94a.754.754 0 0 1 0-1.06c.29-.29.77-.29 1.06 0l1.95 1.95c.19.19.51.19.7 0l2.12-2.11c2.59.81 5.54.18 7.6-1.87 2.95-2.95 2.95-7.76 0-10.71ZM14.499 12a2.5 2.5 0 0 1 0-5 2.5 2.5 0 0 1 0 5Z",fill:r}),e.createElement("path",{d:"M14.5 12a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5Z",fill:r}))},C=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M19.79 14.93a7.575 7.575 0 0 1-7.6 1.87l-4.71 4.7c-.34.35-1.01.56-1.49.49l-2.18-.3c-.72-.1-1.39-.78-1.5-1.5l-.3-2.18c-.07-.48.16-1.15.49-1.49l4.7-4.7c-.8-2.6-.18-5.55 1.88-7.6 2.95-2.95 7.74-2.95 10.7 0 2.96 2.95 2.96 7.76.01 10.71ZM6.89 17.49l2.3 2.3",stroke:r,strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),e.createElement("path",{d:"M14.5 11a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z",stroke:r,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},oe=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M6.18 22.752c-.1 0-.21-.01-.3-.02l-2.17-.3c-1.04-.14-1.98-1.07-2.14-2.13l-.3-2.19c-.1-.7.2-1.61.7-2.12l4.39-4.39c-.71-2.84.11-5.84 2.2-7.91 3.24-3.23 8.51-3.24 11.76 0a8.26 8.26 0 0 1 2.43 5.88c0 2.22-.86 4.31-2.43 5.88-2.1 2.08-5.09 2.9-7.91 2.18l-4.4 4.39c-.42.44-1.17.73-1.83.73Zm8.25-19.99c-1.75 0-3.49.66-4.82 1.99a6.803 6.803 0 0 0-1.7 6.85c.08.27.01.55-.19.75l-4.7 4.7c-.17.17-.31.61-.28.84l.3 2.19c.06.38.47.81.85.86l2.18.3c.24.04.68-.1.85-.27l4.72-4.71c.2-.2.49-.26.75-.18 2.41.76 5.04.11 6.84-1.69 1.28-1.28 1.99-3 1.99-4.82 0-1.83-.71-3.54-1.99-4.82a6.727 6.727 0 0 0-4.8-1.99Z",fill:r}),e.createElement("path",{d:"M9.188 20.54c-.19 0-.38-.07-.53-.22l-2.3-2.3a.754.754 0 0 1 0-1.06c.29-.29.77-.29 1.06 0l2.3 2.3c.29.29.29.77 0 1.06-.15.15-.34.22-.53.22ZM14.5 11.75c-1.24 0-2.25-1.01-2.25-2.25s1.01-2.25 2.25-2.25 2.25 1.01 2.25 2.25-1.01 2.25-2.25 2.25Zm0-3c-.41 0-.75.34-.75.75s.34.75.75.75.75-.34.75-.75-.34-.75-.75-.75Z",fill:r}))},ne=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M19.789 14.93a7.575 7.575 0 0 1-7.6 1.87l-4.71 4.7c-.34.35-1.01.56-1.49.49l-2.18-.3c-.72-.1-1.39-.78-1.5-1.5l-.3-2.18c-.07-.48.16-1.15.49-1.49l4.7-4.7c-.8-2.6-.18-5.55 1.88-7.6 2.95-2.95 7.74-2.95 10.7 0 2.96 2.95 2.96 7.76.01 10.71Z",stroke:r,strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),e.createElement("path",{opacity:".4",d:"m6.89 17.488 2.3 2.3",stroke:r,strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),e.createElement("path",{opacity:".4",d:"M14.5 11a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z",stroke:r,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},le=function(t,r){switch(t){case"Bold":return e.createElement(re,{color:r});case"Broken":return e.createElement(te,{color:r});case"Bulk":return e.createElement(ae,{color:r});case"Linear":return e.createElement(C,{color:r});case"Outline":return e.createElement(oe,{color:r});case"TwoTone":return e.createElement(ne,{color:r});default:return e.createElement(C,{color:r})}},E=h.forwardRef(function(o,t){var r=o.variant,d=o.color,i=o.size,p=Z(o,ee);return e.createElement("svg",B({},p,{xmlns:"http://www.w3.org/2000/svg",ref:t,width:i,height:i,viewBox:"0 0 24 24",fill:"none"}),le(r,d))});E.propTypes={variant:m.oneOf(["Linear","Bold","Broken","Bulk","Outline","TwoTone"]),color:m.string,size:m.oneOfType([m.string,m.number])};E.defaultProps={variant:"Linear",color:"currentColor",size:"24"};E.displayName="Key";var ce=["variant","color","size"],se=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M18 2H6C4.34 2 3 3.33 3 4.97v10.91c0 1.64 1.34 2.97 3 2.97h.76c.8 0 1.56.31 2.12.87l1.71 1.69c.78.77 2.05.77 2.83 0l1.71-1.69c.56-.56 1.33-.87 2.12-.87H18c1.66 0 3-1.33 3-2.97V4.97C21 3.33 19.66 2 18 2Zm-6 3.75c1.29 0 2.33 1.04 2.33 2.33s-1.04 2.33-2.33 2.33-2.33-1.05-2.33-2.33c0-1.29 1.04-2.33 2.33-2.33Zm2.68 9.31H9.32c-.81 0-1.28-.9-.83-1.57.68-1.01 2-1.69 3.51-1.69 1.51 0 2.83.68 3.51 1.69.45.67-.03 1.57-.83 1.57Z",fill:r}))},ie=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M3 4.97C3 3.33 4.34 2 6 2h12c1.66 0 3 1.33 3 2.97v10.91c0 1.64-1.34 2.97-3 2.97h-.76c-.8 0-1.56.31-2.12.87l-1.71 1.69c-.78.77-2.05.77-2.83 0l-1.71-1.69c-.56-.56-1.33-.87-2.12-.87H6c-1.66 0-3-1.33-3-2.97V9.03",stroke:r,strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),e.createElement("path",{d:"M12.002 10a2.33 2.33 0 1 0 0-4.66 2.33 2.33 0 0 0 0 4.66ZM16 15.658c0-1.8-1.79-3.26-4-3.26s-4 1.46-4 3.26",stroke:r,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},de=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{opacity:".4",d:"M18 18.862h-.76c-.8 0-1.56.31-2.12.87l-1.71 1.69c-.78.77-2.05.77-2.83 0l-1.71-1.69c-.56-.56-1.33-.87-2.12-.87H6c-1.66 0-3-1.33-3-2.97V4.982c0-1.64 1.34-2.97 3-2.97h12c1.66 0 3 1.33 3 2.97v10.91c0 1.63-1.34 2.97-3 2.97Z",fill:r}),e.createElement("path",{d:"M12.002 10.41a2.33 2.33 0 1 0 0-4.66 2.33 2.33 0 0 0 0 4.66ZM14.681 15.06c.81 0 1.28-.9.83-1.57-.68-1.01-2-1.69-3.51-1.69-1.51 0-2.83.68-3.51 1.69-.45.67.02 1.57.83 1.57h5.36Z",fill:r}))},T=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M18 18.86h-.76c-.8 0-1.56.31-2.12.87l-1.71 1.69c-.78.77-2.05.77-2.83 0l-1.71-1.69c-.56-.56-1.33-.87-2.12-.87H6c-1.66 0-3-1.33-3-2.97V4.98c0-1.64 1.34-2.97 3-2.97h12c1.66 0 3 1.33 3 2.97v10.91c0 1.63-1.34 2.97-3 2.97Z",stroke:r,strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),e.createElement("path",{d:"M12 10a2.33 2.33 0 1 0 0-4.66A2.33 2.33 0 0 0 12 10ZM16 15.66c0-1.8-1.79-3.26-4-3.26s-4 1.46-4 3.26",stroke:r,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},ue=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M12 22.752c-.7 0-1.41-.27-1.94-.8l-1.71-1.69c-.42-.42-1-.65-1.59-.65H6c-2.07 0-3.75-1.67-3.75-3.72V4.982c0-2.05 1.68-3.72 3.75-3.72h12c2.07 0 3.75 1.67 3.75 3.72v10.91c0 2.05-1.68 3.72-3.75 3.72h-.76a2.3 2.3 0 0 0-1.59.65l-1.71 1.69c-.53.53-1.24.8-1.94.8Zm-6-20c-1.24 0-2.25 1-2.25 2.22v10.91c0 1.23 1.01 2.22 2.25 2.22h.76c.99 0 1.95.4 2.65 1.09l1.71 1.69c.49.48 1.28.48 1.77 0l1.71-1.69c.7-.69 1.66-1.09 2.65-1.09H18c1.24 0 2.25-1 2.25-2.22V4.972c0-1.23-1.01-2.22-2.25-2.22H6Z",fill:r}),e.createElement("path",{d:"M12.002 10.75c-1.7 0-3.08-1.38-3.08-3.08 0-1.7 1.38-3.08 3.08-3.08 1.7 0 3.08 1.38 3.08 3.08 0 1.7-1.38 3.08-3.08 3.08Zm0-4.66c-.87 0-1.58.71-1.58 1.58 0 .87.71 1.58 1.58 1.58.87 0 1.58-.71 1.58-1.58 0-.87-.71-1.58-1.58-1.58ZM16 16.408c-.41 0-.75-.34-.75-.75 0-1.38-1.46-2.51-3.25-2.51s-3.25 1.13-3.25 2.51c0 .41-.34.75-.75.75s-.75-.34-.75-.75c0-2.21 2.13-4.01 4.75-4.01s4.75 1.8 4.75 4.01c0 .41-.34.75-.75.75Z",fill:r}))},me=function(t){var r=t.color;return e.createElement(e.Fragment,null,e.createElement("path",{d:"M18 18.862h-.76c-.8 0-1.56.31-2.12.87l-1.71 1.69c-.78.77-2.05.77-2.83 0l-1.71-1.69c-.56-.56-1.33-.87-2.12-.87H6c-1.66 0-3-1.33-3-2.97V4.982c0-1.64 1.34-2.97 3-2.97h12c1.66 0 3 1.33 3 2.97v10.91c0 1.63-1.34 2.97-3 2.97Z",stroke:r,strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),e.createElement("path",{opacity:".4",d:"M12.002 10a2.33 2.33 0 1 0 0-4.66 2.33 2.33 0 0 0 0 4.66ZM16 15.658c0-1.8-1.79-3.26-4-3.26s-4 1.46-4 3.26",stroke:r,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))},pe=function(t,r){switch(t){case"Bold":return e.createElement(se,{color:r});case"Broken":return e.createElement(ie,{color:r});case"Bulk":return e.createElement(de,{color:r});case"Linear":return e.createElement(T,{color:r});case"Outline":return e.createElement(ue,{color:r});case"TwoTone":return e.createElement(me,{color:r});default:return e.createElement(T,{color:r})}},x=h.forwardRef(function(o,t){var r=o.variant,d=o.color,i=o.size,p=Z(o,ce);return e.createElement("svg",B({},p,{xmlns:"http://www.w3.org/2000/svg",ref:t,width:i,height:i,viewBox:"0 0 24 24",fill:"none"}),pe(r,d))});x.propTypes={variant:m.oneOf(["Linear","Bold","Broken","Bulk","Outline","TwoTone"]),color:m.string,size:m.oneOfType([m.string,m.number])};x.defaultProps={variant:"Linear",color:"currentColor",size:"24"};x.displayName="UserTag";const he=U("div")({width:"100%",overflowX:"auto",display:"block"}),ke=he;function ge({onEdit:o,onDelete:t,onChangePassword:r,onAssignCompanies:d,onToggleActive:i,onViewProfile:p}){return[{id:"select",header:({table:n})=>a.jsx(w,{checked:n.getIsAllPageRowsSelected(),indeterminate:n.getIsSomePageRowsSelected(),onChange:l=>{n.getToggleAllPageRowsSelectedHandler()(l)},sx:{padding:0}}),cell:({row:n})=>a.jsx(w,{checked:n.getIsSelected(),disabled:!n.getCanSelect(),onChange:l=>{n.getToggleSelectedHandler()(l)},sx:{padding:0}}),enableColumnFilter:!1,enableSorting:!1,enableHiding:!1,size:50,meta:{skipFilter:!0}},{header:"Usuario",accessorKey:"userName",cell:({getValue:n})=>a.jsx(k,{variant:"subtitle2",fontWeight:600,children:n()||"N/A"})},{header:"Nombre Completo",accessorKey:"fullName",cell:({getValue:n})=>n()||"N/A"},{header:"Email",accessorKey:"email",cell:({getValue:n})=>a.jsx(k,{variant:"body2",color:"text.secondary",children:n()||"N/A"})},{header:"Rol",accessorKey:"role",cell:({getValue:n})=>{const l=n(),c=l==="Admin"?"primary":"default";return a.jsx(H,{label:l||"User",color:c,size:"small",variant:"light"})}},{header:"Estado",accessorKey:"isActive",cell:({getValue:n,row:l})=>{const c=n(),u=l.original;return a.jsxs(y,{direction:"row",alignItems:"center",spacing:1,children:[a.jsx(X,{checked:c,onChange:()=>i==null?void 0:i(u),size:"small"}),a.jsx(k,{variant:"body2",sx:{fontWeight:500},children:c?"Activo":"Inactivo"})]})}},{header:"Último Acceso",accessorKey:"lastLogin",cell:({getValue:n})=>{const l=n();if(!l)return a.jsx(k,{variant:"body2",color:"text.disabled",children:"Nunca"});const c=new Date(l);return a.jsxs(k,{variant:"body2",children:[c.toLocaleDateString("es-ES")," ",c.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})]})}},{header:"Fecha Creación",accessorKey:"createdAt",cell:({getValue:n})=>{const l=n();return l?new Date(l).toLocaleDateString("es-ES"):"N/A"}},{header:"Acciones",id:"actions",cell:({row:n})=>{const l=n.original,c=()=>p==null?void 0:p(l),u=()=>t==null?void 0:t(l),j=()=>r==null?void 0:r(l),L=()=>d==null?void 0:d(l);return a.jsxs(y,{direction:"row",spacing:.5,alignItems:"center",children:[d&&a.jsx(g,{title:"Asignar Empresas",children:a.jsx(v,{size:"small",color:"info",onClick:L,children:a.jsx(x,{size:18})})}),r&&a.jsx(g,{title:"Cambiar Contraseña",children:a.jsx(v,{size:"small",color:"warning",onClick:j,children:a.jsx(E,{size:18})})}),o&&a.jsx(g,{title:"Editar",children:a.jsx(v,{size:"small",color:"primary",onClick:c,children:a.jsx(G,{size:18})})}),t&&a.jsx(g,{title:"Eliminar",children:a.jsx(v,{size:"small",color:"error",onClick:u,children:a.jsx(K,{size:18})})})]})},enableSorting:!1,enableColumnFilter:!1,size:200}]}function Ue(){const o=N(),{users:t,usersLoading:r}=J(),[d,i]=h.useState(null),[p,n]=h.useState(!1),[l,c]=h.useState(!1),{dialogState:u,openDialog:j,closeDialog:L}=R(),S=s=>{o(`/apps/users/${s.id}/profile/personal`)},z=s=>{o(`/apps/users/edit/${s.id}`)},b=async s=>{j({title:"Eliminar Usuario",message:`¿Está seguro de eliminar el usuario "${s.userName}"?`,severity:"error",confirmText:"Eliminar",onConfirm:async()=>{try{await Y(s.id),f({open:!0,message:"Usuario eliminado exitosamente",variant:"alert",alert:{color:"success"}})}catch{f({open:!0,message:"Error al eliminar el usuario",variant:"alert",alert:{color:"error"}})}}})},F=s=>{i(s),n(!0)},O=s=>{i(s),c(!0)},A=async s=>{const M=!s.isActive;try{await _(s.id,M),f({open:!0,message:`Usuario ${M?"activado":"desactivado"} exitosamente`,variant:"alert",alert:{color:"success"}})}catch{f({open:!0,message:"Error al cambiar el estado del usuario",variant:"alert",alert:{color:"error"}})}},W=h.useMemo(()=>ge({onViewProfile:S,onEdit:z,onDelete:b,onChangePassword:F,onAssignCompanies:O,onToggleActive:A}),[]);return a.jsxs($,{content:!1,children:[a.jsxs(ke,{children:[a.jsx(y,{direction:"row",justifyContent:"flex-end",alignItems:"center",spacing:2,sx:{p:2.5},children:a.jsx(D,{variant:"contained",startIcon:a.jsx(V,{}),onClick:()=>o("/apps/users/create"),children:"Nuevo Usuario"})}),a.jsx(I,{columns:W,data:t||[],loading:r})]}),a.jsx(q,{open:p,user:d,onClose:()=>n(!1)}),a.jsx(Q,{open:l,user:d,onClose:()=>c(!1)}),a.jsx(P,{open:u.open,title:u.title,message:u.message,onConfirm:u.onConfirm,onCancel:L,confirmText:u.confirmText,cancelText:u.cancelText,severity:u.severity})]})}export{Ue as default};
