import{ax as v,r as e,a3 as d,a2 as g,ay as y}from"./index-1Ft_9Ggc.js";import{u as E}from"./useFormErrorRecovery-DSrsCqLh.js";function D(i,{onSuccess:t,onError:n,onRetry:c}={}){const{addError:m}=v(),a=e.useRef(0),o=3,u=e.useCallback((r,s={})=>{var f;m({message:r.message,statusCode:((f=r.response)==null?void 0:f.status)||500,formId:i,timestamp:new Date().toISOString(),context:s})},[i,m]),l=e.useCallback((r,s=null,f="unknown")=>{const k=r.message||"Error en la operaciÃ³n";return u(r,{operation:f,data:s}),d(k,c?()=>c(s):null,r.details||null),n&&n(r,s),{errorId:Date.now(),message:k,data:s,operation:f}},[u,c,n]),b=e.useCallback((r,s=null)=>{g(r),t&&t(s)},[t]),R=e.useCallback(r=>{y(r)},[]),C=e.useCallback(()=>{a.current=0},[]),S=e.useCallback(()=>(a.current+=1,a.current<=o),[]);return{handleError:l,handleSuccess:b,handleWarning:R,logError:u,resetRetryCount:C,incrementRetryCount:S,canRetry:()=>a.current<o,retryCount:a.current}}function F(i,t,n,c=!1){const[m,a]=e.useState(!1),{saveFormDataForRecovery:o,getRecoveredData:u,clearRecoveredData:l}=E(i,t);e.useEffect(()=>{if(!c){const C=u();C&&(a(!0),n(C))}},[c,n,u]),e.useEffect(()=>{o(t)},[t,o]);const b=e.useCallback(()=>{a(!1),l()},[l]),R=e.useCallback(()=>{l()},[l]);return{showRecoveryAlert:m,setShowRecoveryAlert:a,clearRecoveredData:b,onSuccessSubmit:R,saveFormData:o}}export{F as a,D as u};
